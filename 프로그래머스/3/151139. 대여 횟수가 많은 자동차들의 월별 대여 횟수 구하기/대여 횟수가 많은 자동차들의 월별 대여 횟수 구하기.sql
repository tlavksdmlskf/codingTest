SELECT MONTH, CAR_ID, COUNT(DISTINCT HISTORY_ID) AS RECORDS FROM (select history_id, car_id, start_date, extract(month from start_date) as month, end_date from CAR_RENTAL_COMPANY_RENTAL_HISTORY  where  car_id in( select car_id from CAR_RENTAL_COMPANY_RENTAL_HISTORY where START_dATE BETWEEN TO_DATE('2022-08-01', 'YYYY-MM-DD') AND TO_DATE('2022-10-31', 'YYYY-MM-DD') group by car_id having count(DISTINCT HISTORY_ID) >=5 ) ORDER BY CAR_ID ) WHERE START_dATE BETWEEN TO_DATE('2022-08-01', 'YYYY-MM-DD') AND TO_DATE('2022-10-31', 'YYYY-MM-DD') GROUP BY MONTH, CAR_ID ORDER BY MONTH, CAR_ID DESC